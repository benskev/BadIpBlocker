#!/bin/bash

banipsrcset (){
url=$2
name=$1
rm /tmp/ips
wget $url -O /tmp/ips -q
kp_ips="`cat /tmp/ips|grep -Ev '#'|sort -n|uniq`"
echo "Doing $name..."
for k in $kp_ips;
do
#echo $k
fail2ban-client set sshd banip $k > /dev/null
done
echo "$name Done"
}

fail2ban-client unban --all

#ips="164.92.242.27 164.92.242.51 143.198.78.241 164.92.242.27 8.218.51.26 164.92.242.51 143.198.78.241 164.92.242.27 164.92.242.51 47.242.225.18 47.243.168.19 83.242.145.235 "
ips="205.185.122.230 178.79.163.66 79.124.62.110 141.98.10.60 45.155.126.222 136.144.41.3 172.93.111.128 69.49.244.54 100.33.50.34 103.107.58.159 104.244.77.57 119.205.150.227 120.151.35.107 125.121.211.95 14.40.10.202 167.99.38.54 176.58.123.114 201.159.155.159 209.141.62.127 218.72.73.234 38.88.252.186 38.88.252.188 41.44.57.230 45.191.79.192 45.88.137.100 58.57.208.14 74.94.240.163 8.131.94.128 89.33.45.96 90.84.226.16 93.172.243.224 209.141.37.136 178.128.123.138 31.163.196.66 20.55.53.144 23.183.81.249 183.136.226.4 23.183.82.180 164.92.250.114 172.93.110.198 45.134.144.26 209.141.47.245 205.185.124.100 45.144.225.69 167.71.10.210 205.185.114.87 138.118.235.175 162.62.61.98 209.141.33.121 185.189.182.234 23.183.81.54 186.33.92.77 193.142.146.242 178.73.215.171 209.141.34.220 192.35.168.18 45.141.84.10 60.177.147.20 98.165.180.134 205.185.119.112 45.88.137.253 147.182.192.158 200.76.19.13 141.98.10.246 139.162.145.250 185.128.41.50 104.194.8.23 195.133.18.24 183.230.113.53 104.238.220.4 212.192.241.37 85.209.0.186 62.168.187.197 195.133.18.210 178.72.70.142 125.47.245.48 139.59.224.242 121.136.234.16 103.140.251.57 195.230.103.243 206.189.32.125 162.142.125.158 38.88.252.189 192.241.195.226 194.85.250.154 185.167.97.229 104.194.8.56 209.14.131.233 141.98.10.63 172.105.189.111 164.90.206.79 43.131.24.202 42.192.229.5 23.183.81.227 143.244.138.190 193.118.53.204 38.88.252.187 83.149.87.180 104.248.203.112 104.206.128.30 45.61.186.123 20.107.186.152 195.230.103.242 209.141.61.41 167.94.138.17 198.98.49.124 61.7.214.154 93.174.93.236 125.121.135.84 20.62.168.122 121.136.234.50 104.194.8.73 23.183.82.135 92.118.160.9 64.246.161.26 167.71.66.236 137.184.51.62 185.254.31.134 167.99.164.153 89.248.168.112 117.68.2.55 45.146.164.128 104.194.8.70 161.35.153.169 205.185.126.99 128.1.248.26 209.141.33.193 34.96.130.28 92.63.197.71 65.49.20.112 79.238.17.127 199.19.224.231 167.71.102.95 205.185.119.40 180.97.242.100 23.148.145.233 167.172.148.206 192.241.211.97 198.199.104.21 107.189.30.134 34.72.10.115 82.66.108.19 80.82.77.85 209.141.57.164 34.89.210.222 192.241.213.80 66.240.236.116 192.241.209.104 192.241.208.126 192.35.168.115 18.218.248.238 142.93.163.195 185.239.236.221 162.142.125.21 209.17.96.202 192.241.204.39 192.81.130.58 162.142.125.150 138.197.189.44 164.92.252.236 194.85.248.46 66.240.205.34 162.221.192.27 51.68.111.184 209.17.96.82 159.65.140.76 134.209.183.132 202.58.196.208 46.37.126.122 20.62.170.136 45.134.144.45 194.85.248.161 52.148.136.197 164.92.242.36 104.206.128.2 159.223.20.136 184.105.139.72 167.71.72.174 45.115.254.238 195.37.190.89 192.241.214.95 102.221.156.15 118.112.248.111 192.241.211.225 164.92.252.237 209.17.96.34 209.17.96.2 223.223.191.13 138.204.133.80 45.137.20.225 23.183.83.195 167.99.39.128 110.77.212.92 94.232.43.63 167.94.138.30 92.118.160.37 2.183.198.37 134.255.227.181 66.45.234.187 185.180.143.138 162.142.125.24 209.17.96.210 159.89.16.100 195.29.224.114 23.251.102.78 209.17.96.154 193.169.254.179 186.211.108.71 139.162.215.235 65.49.20.115 193.29.14.205 80.82.70.228 162.142.125.147 167.172.214.198 159.65.82.183 172.104.131.24"
echo $ips > /tmp/ips
ips2="`cat /tmp/ips|sort -n|uniq`"
echo "Doing randos..."
for i in $ips2
do
#echo $i
fail2ban-client set sshd banip $i > /dev/null
done
echo "Randos done."
banipsrcset "TALOS list" "https://www.talosintelligence.com/documents/ip-blacklist" ;
banipsrcset "TOR Endpoints" "https://check.torproject.org/torbulkexitlist";
#https://raw.githubusercontent.com/Sh1n0g1/North-Korea-IP-Addresses/master/kp_ip_address
banipsrcset "Tlue Kolea" "https://raw.githubusercontent.com/Sh1n0g1/North-Korea-IP-Addresses/master/kp_ip_address";
banipsrcset "feodo" "https://feodotracker.abuse.ch/downloads/ipblocklist_recommended.txt";
banipsrcset "feodo2" "https://feodotracker.abuse.ch/downloads/ipblocklist.txt";
banipsrcset "sslipblacklist" "https://sslbl.abuse.ch/blacklist/sslipblacklist_aggressive.txt";
banipsrcset "blocklist.de" "https://lists.blocklist.de/lists/all.txt"
banipsrcset "EmergingThreats compromised IPs" "https://rules.emergingthreats.net/blockrules/compromised-ips.txt"
banipsrcset "CINS Badguys" "https://cinsscore.com/list/ci-badguys.txt"
banipsrcset "ELLIOTech badips" "https://cdn.ellio.tech/community-feed"
banipsrcset "Marai list" "https://mirai.security.gives/data/ip_list.txt"
